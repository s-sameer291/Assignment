trigger:
- none

pool:
  name: agent12


steps:
- task: TerraformInstaller@1
  inputs:
    terraformVersion: '1.6.6'

- task: PowerShell@2
  inputs:
    targetType: 'inline'
    script: '& "C:\agent\_work\_tool\terraform\1.6.6\x64\terraform.exe" version'

- task: TerraformTask@5
  inputs:
    provider: 'azurerm'
    command: 'init'
    workingDirectory: '$(System.DefaultWorkingDirectory)/Parent-Module'
    backendServiceArm: 'My_connection'
    backendAzureRmStorageAccountName: 'storageassig1912'
    backendAzureRmContainerName: 'blobcon'
    backendAzureRmKey: 'terraform.tfstate'

# stages:
# - stage: Plan
#   displayName: Terraform Plan Stage
#   jobs:
#   - job: terraforminit
#     displayName: Terraform Job
#     steps:
#     - task: TerraformInstaller@1
#       inputs:
#         terraformVersion: 'latest'

#     - task: TerraformTask@5
#       inputs:
#         provider: 'azurerm'
#         command: 'init'
#         workingDirectory: '$(System.DefaultWorkingDirectory)/Parent-Module'
#         backendServiceArm: 'My_connection'
#         backendAzureRmStorageAccountName: 'storageassig1912'
#         backendAzureRmContainerName: 'blobcon'
#         backendAzureRmKey: 'terraform.tfstate'

